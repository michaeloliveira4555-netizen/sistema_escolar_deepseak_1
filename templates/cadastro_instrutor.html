{% extends "base.html" %}

{% block title %}Cadastro de Instrutor{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card">
        <h2>{% if is_admin_flow %}Cadastrar Novo Instrutor{% else %}Completar Perfil de Instrutor{% endif %}</h2>
        <form method="POST" action="{% if is_admin_flow %}{{ url_for('instrutor.cadastro_instrutor_admin') }}{% else %}{{ url_for('instrutor.cadastro_instrutor') }}{% endif %}">
            
            {% if is_admin_flow %}
                <div class="form-group">
                    <label for="nome_completo">Nome Completo:</label>
                    <input type="text" id="nome_completo" name="nome_completo" value="{{ form_data.nome_completo if form_data else '' }}" required>
                </div>
                <div class="form-group">
                    <label for="matricula">Matrícula (será usada para o login):</label>
                    <input type="text" id="matricula" name="matricula" value="{{ form_data.matricula if form_data else '' }}" required>
                </div>
                <div class="form-group">
                    <label for="email">E-mail:</label>
                    <input type="email" id="email" name="email" value="{{ form_data.email if form_data else '' }}" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha:</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <div class="form-group">
                    <label for="password2">Confirmar Senha:</label>
                    <input type="password" id="password2" name="password2" required>
                </div>
                <hr class="my-4">
                <h3>Detalhes do Perfil do Instrutor</h3>
            {% endif %}

            <div class="form-group">
                <label for="especializacao">Especialização:</label>
                <input type="text" class="form-control" id="especializacao" name="especializacao" value="{{ instrutor.especializacao if instrutor else (form_data.especializacao if form_data else '') }}">
            </div>
            <div class="form-group">
                <label for="formacao">Formação:</label>
                <input type="text" class="form-control" id="formacao" name="formacao" value="{{ instrutor.formacao if instrutor else (form_data.formacao if form_data else '') }}">
            </div>
            <div class="form-group">
                <label for="telefone">Telefone:</label>
                <input type="text" class="form-control" id="telefone" name="telefone" value="{{ instrutor.telefone if instrutor else (form_data.telefone if form_data else '') }}" placeholder="(XX) XXXXX-XXXX">
            </div>

            <button type="submit" class="btn btn-primary">Salvar Perfil</button>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const telefoneInput = document.getElementById('telefone');

        if (telefoneInput) {
            telefoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 11) value = value.slice(0, 11);

                if (value.length > 10) {
                    value = value.replace(/^(\d{2})(\d{5})(\d{4}).*/, '($1) $2-$3');
                } else if (value.length > 6) {
                    value = value.replace(/^(\d{2})(\d{4})(\d{4}).*/, '($1) $2-$3');
                } else if (value.length > 2) {
                    value = value.replace(/^(\d{2})(\d{0,5})/, '($1) $2');
                } else if (value.length > 0) {
                    value = value.replace(/^(\d{0,2})/, '($1');
                }
                e.target.value = value;
            });
        }
    });
</script>

{% endblock %}