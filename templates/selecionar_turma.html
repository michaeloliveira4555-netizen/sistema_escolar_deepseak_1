{% extends "base.html" %}

{% block title %}Selecionar Turma{% endblock %}

{% block content %}
<div class="content-header">
    <h1>{{ title }}</h1>
    <p>Semana selecionada: <strong>{{ semana.nome }} ({{ semana.data_inicio.strftime('%d/%m') }} a {{ semana.data_fim.strftime('%d/%m') }})</strong></p>
    <p>Agora, selecione um pelotão para continuar.</p>
</div>

<div class="table-container" style="max-width: 800px; margin: 0 auto;">
    <form method="POST" action="{{ url_for(target_endpoint) }}">
        <input type="hidden" name="semana_id" value="{{ semana.id }}">

        <div class="table-filters">
            <strong>Escolha o Pelotão:</strong>
            <div class="filter-buttons" id="pelotao-selector">
                {% for i in range(1, 11) %}
                <button type="button" class="btn btn-sm btn-secondary" data-pelotao="{{ i }}° Pelotão">
                    {{ i }}º Pelotão
                </button>
                {% endfor %}
            </div>
            <input type="hidden" name="pelotao" id="selected-pelotao" required>
        </div>

        <div class="form-actions" style="justify-content: center; margin-top: 2rem;">
            <a href="{{ url_for('horario.index') }}" class="btn btn-secondary">Voltar</a>
            <button type="submit" class="btn btn-primary" id="confirm-button" disabled>Confirmar</button>
        </div>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const buttons = document.querySelectorAll('#pelotao-selector button');
    const hiddenInput = document.getElementById('selected-pelotao');
    const confirmButton = document.getElementById('confirm-button');

    buttons.forEach(button => {
        button.addEventListener('click', function() {
            buttons.forEach(btn => {
                btn.classList.remove('btn-primary');
                btn.classList.add('btn-secondary');
            });

            this.classList.remove('btn-secondary');
            this.classList.add('btn-primary');

            hiddenInput.value = this.dataset.pelotao;
            confirmButton.disabled = false;
        });
    });
});
</script>
{% endblock %}